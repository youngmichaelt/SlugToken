{"ast":null,"code":"import _asyncToGenerator from\"/Users/michaelyoung/repos/SlugToken/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/michaelyoung/repos/SlugToken/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/michaelyoung/repos/SlugToken/node_modules/@babel/runtime/regenerator/index.js\";import{React,useState,useEffect}from'react';import{ethers}from'ethers';import Spinner from'react-bootstrap/Spinner';import ProgressBar from'react-bootstrap/ProgressBar';import*as Loader from'react-loader-spinner';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Interactions=function Interactions(props){var _useState=useState(),_useState2=_slicedToArray(_useState,2),txnHash=_useState2[0],setTxnHash=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),allowance=_useState4[0],setAllowance=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),selfAllowance=_useState6[0],setSelfAllowance=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),ApproveOrStake=_useState8[0],setApproveOrStake=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),stakeBalance=_useState10[0],setStakeBalance=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),unstakeBalance=_useState12[0],setUnstakeBalance=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),stakeAmountState=_useState14[0],setStakeAmount=_useState14[1];var _useState15=useState(),_useState16=_slicedToArray(_useState15,2),stakeState=_useState16[0],setStakeState=_useState16[1];var _useState17=useState(),_useState18=_slicedToArray(_useState17,2),txnPending=_useState18[0],setTxnPending=_useState18[1];var _useState19=useState(),_useState20=_slicedToArray(_useState19,2),txnComplete=_useState20[0],setTxnComplete=_useState20[1];var _useState21=useState(\"Token\"),_useState22=_slicedToArray(_useState21,2),tokenName=_useState22[0],setTokenName=_useState22[1];var _useState23=useState(0),_useState24=_slicedToArray(_useState23,2),balance=_useState24[0],setBalance=_useState24[1];var _useState25=useState(null),_useState26=_slicedToArray(_useState25,2),maxStakeAmount=_useState26[0],setMaxStakeAmount=_useState26[1];var contract=props.contract.contract;var defaultAccount=props.contract.defaultAccount;var provider=props.contract.provider;var setOpenModal=props.contract.setOpenModal;var setErrorMessage=props.contract.setErrorMessage;var network=props.contract.network;var approveOrStake=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var contractAddress,account,_allowance,allowanceBalance,_selfAllowance,selfAllowanceBalance;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(!(defaultAccount!=null&&defaultAccount.length!=0)){_context.next=21;break;}_context.next=4;return contract.address;case 4:contractAddress=_context.sent;account=defaultAccount;if(account instanceof Array){account=account[0];}_context.next=9;return contract.allowance(account,contractAddress);case 9:_allowance=_context.sent;allowanceBalance=_allowance*Math.pow(10,18);setAllowance(ethers.utils.formatUnits(_allowance,18));console.log(ethers.utils.formatUnits(_allowance,18));_context.next=15;return contract.allowance(account,account);case 15:_selfAllowance=_context.sent;selfAllowanceBalance=_selfAllowance*Math.pow(10,18);setSelfAllowance(ethers.utils.formatUnits(_selfAllowance,18));if(allowanceBalance>0&&selfAllowanceBalance>0){setApproveOrStake(\"Stake\");}else{setApproveOrStake(\"Approve\");}_context.next=22;break;case 21:setApproveOrStake(\"Stake\");case 22:_context.next=28;break;case 24:_context.prev=24;_context.t0=_context[\"catch\"](0);setOpenModal(true);setErrorMessage(_context.t0);case 28:case\"end\":return _context.stop();}}},_callee,null,[[0,24]]);}));return function approveOrStake(){return _ref.apply(this,arguments);};}();var getStakeBalance=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var isStakeHolder,stakeId,_yield$contract$isSta,_yield$contract$isSta2,_yield$contract$isSta3,_yield$contract$isSta4,stakeAmountBig,stakeAmount;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;isStakeHolder=false;stakeId=0;if(!(defaultAccount!=null&&defaultAccount.length>0)){_context2.next=37;break;}if(!(defaultAccount instanceof Array)){_context2.next=13;break;}_context2.next=7;return contract.isStakeholder(defaultAccount[0]);case 7:_yield$contract$isSta=_context2.sent;_yield$contract$isSta2=_slicedToArray(_yield$contract$isSta,2);isStakeHolder=_yield$contract$isSta2[0];stakeId=_yield$contract$isSta2[1];_context2.next=19;break;case 13:_context2.next=15;return contract.isStakeholder(defaultAccount);case 15:_yield$contract$isSta3=_context2.sent;_yield$contract$isSta4=_slicedToArray(_yield$contract$isSta3,2);isStakeHolder=_yield$contract$isSta4[0];stakeId=_yield$contract$isSta4[1];case 19:if(!(isStakeHolder==true)){_context2.next=34;break;}stakeAmountBig=0;if(!(defaultAccount instanceof Array)){_context2.next=27;break;}_context2.next=24;return contract.stakedTokens(defaultAccount[0]);case 24:stakeAmountBig=_context2.sent;_context2.next=30;break;case 27:_context2.next=29;return contract.stakedTokens(defaultAccount);case 29:stakeAmountBig=_context2.sent;case 30:stakeAmount=ethers.utils.formatUnits(stakeAmountBig,18);setStakeBalance(stakeAmount);_context2.next=35;break;case 34:setStakeBalance(0);case 35:_context2.next=39;break;case 37:setStakeBalance(0);setBalance(0);case 39:_context2.next=45;break;case 41:_context2.prev=41;_context2.t0=_context2[\"catch\"](0);setOpenModal(true);setErrorMessage(_context2.t0);case 45:case\"end\":return _context2.stop();}}},_callee2,null,[[0,41]]);}));return function getStakeBalance(){return _ref2.apply(this,arguments);};}();var stakeStateHandler=function stakeStateHandler(){if(stakeState==\"Unstake\"){setApproveOrStake(\"Unstake\");}else{if(defaultAccount!=null&&defaultAccount.length>0){approveOrStake();}}};var approveStakeHandler=function approveStakeHandler(e){var stakeAmount=e;if(stakeState!=\"Unstake\"){if(stakeAmount<=parseInt(allowance)&&stakeAmount<=parseInt(selfAllowance)){setApproveOrStake(\"Stake\");}else if(stakeAmount==0){setApproveOrStake(\"Stake\");}else{setApproveOrStake(\"Approve\");}}};var stakeHandler=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var contractAddress,unstakeAmount,unstakeAmountBig,txn,_contractAddress,stakeAmount,stakeAmountBig,_txn,approveSelftxn,_txn2;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:e.preventDefault();console.log(defaultAccount);_context3.prev=2;if(!(stakeState==\"Unstake\")){_context3.next=21;break;}_context3.next=6;return contract.address;case 6:contractAddress=_context3.sent;unstakeAmount=parseInt(stakeAmountState);unstakeAmountBig=ethers.utils.parseUnits(stakeAmountState,18);if(!(stakeBalance>unstakeAmount)){_context3.next=18;break;}_context3.next=12;return contract.unstakeToken(unstakeAmountBig);case 12:txn=_context3.sent;console.log(txn);setTxnHash(\"Unstake transaction confirmation hash: \"+txn.hash);pollTransaction(txn.hash);// setStakeAmount(0);\n// let balance = 0;\n_context3.next=19;break;case 18:window.alert(\"You cannot unstake more tokens than you have staked...\");case 19:_context3.next=49;break;case 21:_context3.next=23;return contract.address;case 23:_contractAddress=_context3.sent;stakeAmount=parseFloat(stakeAmountState);stakeAmountBig=ethers.utils.parseUnits(stakeAmountState,18);// let allowanceBig = ethers.utils.parseUnits(allowance.toString());\nconsole.log(parseFloat(allowance),selfAllowance,parseFloat(ethers.utils.formatUnits(stakeAmountBig,0)),stakeAmount);if(!(stakeAmount>balance)){_context3.next=31;break;}window.alert(\"You do not have enough tokens...\");_context3.next=49;break;case 31:if(!(stakeAmount<=parseFloat(allowance)&&stakeAmount<=parseFloat(selfAllowance))){_context3.next=40;break;}_context3.next=34;return contract.stakeToken(stakeAmountBig);case 34:_txn=_context3.sent;console.log(_txn);setTxnHash(\"Stake transaction confirmation hash: \"+_txn.hash);pollTransaction(_txn.hash);// setStakeAmount(0);\n_context3.next=49;break;case 40:_context3.next=42;return contract.approve(defaultAccount,stakeAmountBig);case 42:approveSelftxn=_context3.sent;_context3.next=45;return contract.approve(_contractAddress,stakeAmountBig);case 45:_txn2=_context3.sent;console.log(_txn2);setTxnHash(\"Approval transaction confirmation hash: \"+_txn2.hash);pollTransaction(_txn2.hash);case 49:_context3.next=55;break;case 51:_context3.prev=51;_context3.t0=_context3[\"catch\"](2);setOpenModal(true);if(typeof _context3.t0==='object'){setErrorMessage(_context3.t0.message);}else{console.log(_context3.t0);setErrorMessage(_context3.t0);}case 55:case\"end\":return _context3.stop();}}},_callee3,null,[[2,51]]);}));return function stakeHandler(_x){return _ref3.apply(this,arguments);};}();// const unstakeHandler = async (e) => {\n//     e.preventDefault();\n//     let contractAddress = await contract.address;\n//     let unstakeAmount = parseInt(e.target.unstakeAmount.value);\n//     let unstakeAmountBig = ethers.utils.parseUnits(e.target.unstakeAmount.value, 18);\n//     if (stakeBalance > unstakeAmount){\n//         let txn = await contract.unstakeToken(unstakeAmountBig);\n//         console.log(txn);\n//         setTxnHash(\"Unstake transaction confirmation hash: \" + txn.hash);\n//         pollTransaction(txn.hash);\n//         balance = 0;\n//     } else {\n//         window.alert(\"You cannot unstake more tokens than you have staked...\");\n//     }\n// }\nvar pollTransaction=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(txnHash){var txn,time;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return provider.getTransactionReceipt(txnHash);case 3:txn=_context4.sent;time=0;setApproveOrStake(/*#__PURE__*/_jsx(\"span\",{className:\"justify-center flex\",children:/*#__PURE__*/_jsx(Loader.Oval,{className:\"\",type:\"Circles\",color:\"#000000\",height:30,width:30})}));case 6:if(!(txn==null&&time<30)){_context4.next=15;break;}_context4.next=9;return new Promise(function(r){return setTimeout(r,2000);});case 9:_context4.next=11;return provider.getTransactionReceipt(txnHash);case 11:txn=_context4.sent;time+=1;_context4.next=6;break;case 15:if(time==30){setTxnPending(\"Time out error, check your transaction to make sure it went through\");}else{setTxnPending(\"txn complete\");}setTxnComplete(txnHash);stakeStateHandler();_context4.next=24;break;case 20:_context4.prev=20;_context4.t0=_context4[\"catch\"](0);setOpenModal(true);setErrorMessage(_context4.t0);case 24:case\"end\":return _context4.stop();}}},_callee4,null,[[0,20]]);}));return function pollTransaction(_x2){return _ref4.apply(this,arguments);};}();var updateTokenName=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var name;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return contract.name();case 2:name=_context5.sent;setTokenName(name);case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function updateTokenName(){return _ref5.apply(this,arguments);};}();var updateBalance=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var balanceBigN,balanceNumber,tokenDecimals,tokenBalance;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:balanceBigN=0;if(!(defaultAccount instanceof Array)){_context6.next=7;break;}_context6.next=4;return contract.balanceOf(defaultAccount[0]);case 4:balanceBigN=_context6.sent;_context6.next=10;break;case 7:_context6.next=9;return contract.balanceOf(defaultAccount);case 9:balanceBigN=_context6.sent;case 10:balanceNumber=balanceBigN;_context6.next=13;return contract.decimals();case 13:tokenDecimals=_context6.sent;tokenBalance=balanceNumber/Math.pow(10,18);console.log(2*Math.pow(10,18));setBalance(tokenBalance.toFixed(5));case 17:case\"end\":return _context6.stop();}}},_callee6);}));return function updateBalance(){return _ref6.apply(this,arguments);};}();var maxStakeAmountHandler=function maxStakeAmountHandler(){if(stakeState==\"Unstake\"){setStakeAmount(stakeBalance);}else{setStakeAmount(balance);}};useEffect(function(){if(contract!=null){if(network=='rinkeby'){updateBalance();updateTokenName();// approveOrStake();\nstakeStateHandler();getStakeBalance();}else if(network!=null){setOpenModal(true);setErrorMessage(\"Wrong network\");}}else{setApproveOrStake(\"Approve\");}},[contract,defaultAccount,stakeState,txnComplete,network]);//contract, defaultAccount, txnPending, stakeState]\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\" pt-4 bg-white pixel-border border-gray-200 shadow-md sm:p-6 lg:p-8 dark:bg-gray-800 dark:border-gray-700 \",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"mx-5 mb-5 px-4 py-2 bg-lime-400 hover:bg-lime-600 pixel-border text-center\",onClick:function onClick(){return setStakeState(\"Stake\");},children:/*#__PURE__*/_jsx(\"span\",{className:\"\",children:\"Stake\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"mx-5 mb-5 px-4 py-2 bg-lime-400 hover:bg-lime-600 pixel-border text-center\",onClick:function onClick(){return setStakeState(\"Unstake\");},children:/*#__PURE__*/_jsx(\"span\",{children:\"Unstake\"})}),/*#__PURE__*/_jsx(\"hr\",{className:\"pb-5\"})]}),/*#__PURE__*/_jsx(\"div\",{id:\"stake-detail\",className:\"mx-3\",children:/*#__PURE__*/_jsxs(\"div\",{id:\"amount\",className:\"bg-lime-500 pixel-border px-3 py-10 \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-15 mb-2 text-left text-black\",children:\"Amount\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex md:mx-5 \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"ml-10 mr-4\",children:/*#__PURE__*/_jsx(\"input\",{className:\"pixel-border xl:text-xl lg:text-xl md:text-xl sm:text-xl\",onChange:function onChange(e){setStakeAmount(e.target.value);approveStakeHandler(e.target.value);},id:\"stakeAmount\",type:\"number\",min:\"0\",step:\"0.001\",placeholder:\"0\",value:stakeAmountState})}),/*#__PURE__*/_jsx(\"button\",{className:\"pixel-border bg-lime-200 w-16 hover:bg-lime-600\",onClick:function onClick(e){maxStakeAmountHandler();},children:/*#__PURE__*/_jsx(\"span\",{children:\"Max\"})})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-10 mb-10 mr-3 ml-3  \",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex pb-10 relative\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"left-0 absolute\",children:\"Balance: \"}),/*#__PURE__*/_jsx(\"p\",{className:\"right-0 absolute\",children:balance})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex mb-10 relative\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"left-0 absolute\",children:\"Staked balance: \"}),/*#__PURE__*/_jsx(\"p\",{className:\"right-0 absolute\",children:stakeBalance})]})]}),/*#__PURE__*/_jsx(\"button\",{disabled:stakeAmountState==0||stakeAmountState==null,className:\"pixel-border bg-lime-500 disabled:bg-lime-100 active:bg-lime-500 hover:bg-lime-600 xl:w-96 lg:w-96 md:w-96 sm:w-96 w-80 py-3 my-5\",type:\"submit\",onClick:stakeHandler,children:ApproveOrStake}),/*#__PURE__*/_jsx(\"div\",{className:\"px-10\"})]});};export default Interactions;","map":{"version":3,"sources":["/Users/michaelyoung/repos/SlugToken/src/Interactions.js"],"names":["React","useState","useEffect","ethers","Spinner","ProgressBar","Loader","Interactions","props","txnHash","setTxnHash","allowance","setAllowance","selfAllowance","setSelfAllowance","ApproveOrStake","setApproveOrStake","stakeBalance","setStakeBalance","unstakeBalance","setUnstakeBalance","stakeAmountState","setStakeAmount","stakeState","setStakeState","txnPending","setTxnPending","txnComplete","setTxnComplete","tokenName","setTokenName","balance","setBalance","maxStakeAmount","setMaxStakeAmount","contract","defaultAccount","provider","setOpenModal","setErrorMessage","network","approveOrStake","length","address","contractAddress","account","Array","allowanceBalance","Math","pow","utils","formatUnits","console","log","selfAllowanceBalance","getStakeBalance","isStakeHolder","stakeId","isStakeholder","stakeAmountBig","stakedTokens","stakeAmount","stakeStateHandler","approveStakeHandler","e","parseInt","stakeHandler","preventDefault","unstakeAmount","unstakeAmountBig","parseUnits","unstakeToken","txn","hash","pollTransaction","window","alert","parseFloat","stakeToken","approve","approveSelftxn","message","getTransactionReceipt","time","Promise","r","setTimeout","updateTokenName","name","updateBalance","balanceBigN","balanceOf","balanceNumber","decimals","tokenDecimals","tokenBalance","toFixed","maxStakeAmountHandler","target","value"],"mappings":"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","sourcesContent":["import {React, useState, useEffect} from 'react'\nimport {ethers} from 'ethers'\nimport Spinner from 'react-bootstrap/Spinner';\nimport ProgressBar from 'react-bootstrap/ProgressBar';\nimport * as Loader from 'react-loader-spinner';\n\nconst Interactions = (props) => {\n\n    const [txnHash, setTxnHash] = useState();\n\n    const [allowance, setAllowance] = useState();\n    const [selfAllowance, setSelfAllowance] = useState();\n    const [ApproveOrStake, setApproveOrStake] = useState();\n    const [stakeBalance, setStakeBalance] = useState(0);\n    const [unstakeBalance, setUnstakeBalance] = useState();\n\n    const [stakeAmountState, setStakeAmount] = useState();\n    const [stakeState, setStakeState] = useState();\n\n    const [txnPending, setTxnPending] = useState();\n    const [txnComplete, setTxnComplete] = useState();\n\n    const [tokenName, setTokenName] = useState(\"Token\");\n    const [balance, setBalance] = useState(0);\n\n    const [maxStakeAmount, setMaxStakeAmount] = useState(null);\n\n\n    \n\n    let contract = props.contract.contract;\n    let defaultAccount = props.contract.defaultAccount;\n    let provider = props.contract.provider;\n    let setOpenModal = props.contract.setOpenModal;\n    let setErrorMessage = props.contract.setErrorMessage;\n    let network = props.contract.network;\n\n    \n\n    const approveOrStake = async () => {\n        try{\n            if (defaultAccount != null && defaultAccount.length != 0){\n                let contractAddress = await contract.address;\n                let account = defaultAccount\n                if (account instanceof Array){\n                    account = account[0];\n                }\n                let allowance = await contract.allowance(account, contractAddress);\n\n                let allowanceBalance = allowance * Math.pow(10, 18);\n                setAllowance(ethers.utils.formatUnits(allowance,18));\n                console.log(ethers.utils.formatUnits(allowance,18))\n\n                let selfAllowance = await contract.allowance(account, account);\n                let selfAllowanceBalance = selfAllowance * Math.pow(10, 18);\n                setSelfAllowance(ethers.utils.formatUnits(selfAllowance,18));\n\n                if (allowanceBalance > 0 && selfAllowanceBalance > 0){\n                    setApproveOrStake(\"Stake\");\n                } else {\n                    setApproveOrStake(\"Approve\");\n                }\n            } else {\n                setApproveOrStake(\"Stake\");\n            }\n            \n        } catch (e) {   \n            setOpenModal(true);\n            setErrorMessage(e);\n        }\n        \n    }\n\n    const getStakeBalance = async () =>{\n        try {\n            let isStakeHolder = false;\n            let stakeId = 0;\n            if (defaultAccount != null && defaultAccount.length > 0){\n                if (defaultAccount instanceof Array){\n                    [isStakeHolder, stakeId] = await contract.isStakeholder(defaultAccount[0]);\n                } else {\n                    [isStakeHolder, stakeId] = await contract.isStakeholder(defaultAccount);\n                }\n                \n                \n                if (isStakeHolder == true){\n                    let stakeAmountBig = 0;\n                    if (defaultAccount instanceof Array){\n                        stakeAmountBig = await contract.stakedTokens(defaultAccount[0]);\n                    } else {\n                        stakeAmountBig = await contract.stakedTokens(defaultAccount);\n                    }\n                    \n                    let stakeAmount = ethers.utils.formatUnits(stakeAmountBig, 18)\n                    setStakeBalance(stakeAmount);\n                } else {\n                    setStakeBalance(0);\n                }\n            } else {\n                setStakeBalance(0);\n                setBalance(0)\n\n            }\n            \n        } catch (e) {   \n            setOpenModal(true);\n            setErrorMessage(e);\n        }\n        \n    }\n\n    const stakeStateHandler = () => {\n        if (stakeState == \"Unstake\"){\n            setApproveOrStake(\"Unstake\")\n\n\n        } else {\n            if (defaultAccount != null && defaultAccount.length > 0){\n                approveOrStake();\n            }\n            \n        }\n    }\n\n    const approveStakeHandler = (e) => {\n\n        let stakeAmount = e;\n        if (stakeState != \"Unstake\"){\n            if (stakeAmount <= parseInt(allowance) && stakeAmount <= parseInt(selfAllowance)){\n                setApproveOrStake(\"Stake\");\n            }\n            else if (stakeAmount == 0){\n                setApproveOrStake(\"Stake\");\n            }\n            else {\n                setApproveOrStake(\"Approve\");\n            }\n        }\n    }\n\n    \n\n    \n\n    const stakeHandler = async (e) => {\n        e.preventDefault();\n        console.log(defaultAccount);\n\n        try {\n            if (stakeState == \"Unstake\"){\n                let contractAddress = await contract.address;\n                let unstakeAmount = parseInt(stakeAmountState);\n                let unstakeAmountBig = ethers.utils.parseUnits(stakeAmountState, 18);\n    \n                if (stakeBalance > unstakeAmount){\n                    let txn = await contract.unstakeToken(unstakeAmountBig);\n                    console.log(txn);\n                    setTxnHash(\"Unstake transaction confirmation hash: \" + txn.hash);\n    \n                    pollTransaction(txn.hash);\n                    // setStakeAmount(0);\n    \n                    // let balance = 0;\n                    \n                } else {\n                    window.alert(\"You cannot unstake more tokens than you have staked...\");\n                }\n            } else {\n                let contractAddress = await contract.address;\n               \n                let stakeAmount = parseFloat(stakeAmountState);\n                let stakeAmountBig = ethers.utils.parseUnits(stakeAmountState, 18);\n                // let allowanceBig = ethers.utils.parseUnits(allowance.toString());\n                console.log(parseFloat(allowance),selfAllowance, parseFloat(ethers.utils.formatUnits(stakeAmountBig,0)), stakeAmount)\n                if (stakeAmount > balance){\n                    window.alert(\"You do not have enough tokens...\");\n                } else {\n                    if (stakeAmount <= parseFloat(allowance) && stakeAmount <= parseFloat(selfAllowance)){\n    \n                        let txn = await contract.stakeToken(stakeAmountBig);\n                        console.log(txn);\n                        setTxnHash(\"Stake transaction confirmation hash: \" + txn.hash);\n                        pollTransaction(txn.hash);\n                        // setStakeAmount(0);\n        \n                    } else {\n                        let approveSelftxn = await contract.approve(defaultAccount, stakeAmountBig);\n                        let txn = await contract.approve(contractAddress, stakeAmountBig);\n                        console.log(txn);\n                        setTxnHash(\"Approval transaction confirmation hash: \" + txn.hash);\n                        pollTransaction(txn.hash);\n                    }\n                }\n                \n            }\n        } catch (e) {   \n            setOpenModal(true);\n\n            if (typeof e === 'object'){\n                setErrorMessage(e.message);\n            } else {\n                console.log(e);\n                setErrorMessage(e);\n            }\n            \n        }\n\n        \n        \n    }\n\n    // const unstakeHandler = async (e) => {\n    //     e.preventDefault();\n    //     let contractAddress = await contract.address;\n    //     let unstakeAmount = parseInt(e.target.unstakeAmount.value);\n    //     let unstakeAmountBig = ethers.utils.parseUnits(e.target.unstakeAmount.value, 18);\n\n    //     if (stakeBalance > unstakeAmount){\n    //         let txn = await contract.unstakeToken(unstakeAmountBig);\n    //         console.log(txn);\n    //         setTxnHash(\"Unstake transaction confirmation hash: \" + txn.hash);\n\n    //         pollTransaction(txn.hash);\n\n    //         balance = 0;\n            \n    //     } else {\n    //         window.alert(\"You cannot unstake more tokens than you have staked...\");\n    //     }\n        \n    // }\n\n    const pollTransaction = async (txnHash) => {\n        try{\n            let txn = await provider.getTransactionReceipt(txnHash);\n            let time = 0;\n            setApproveOrStake(<span className='justify-center flex'>                \n            <Loader.Oval className='' type=\"Circles\" color=\"#000000\" height={30} width={30}/>\n            </span>);\n        \n\n            while (txn == null && time < 30){\n                await new Promise(r => setTimeout(r, 2000));\n                txn = await provider.getTransactionReceipt(txnHash);\n                time += 1;\n                \n            }\n            if (time == 30){\n                setTxnPending(\"Time out error, check your transaction to make sure it went through\");\n            } else {\n                setTxnPending(\"txn complete\");\n            }\n            \n            setTxnComplete(txnHash);\n            stakeStateHandler();\n        } catch (e) {   \n            setOpenModal(true);\n            setErrorMessage(e);\n        }\n        \n\n        \n    }\n    const updateTokenName = async () => {\n        let name = await contract.name();\n\n        setTokenName(name);\n    }\n    const updateBalance = async () => {\n        \n        let balanceBigN = 0;\n\n        if (defaultAccount instanceof Array){\n            balanceBigN = await contract.balanceOf(defaultAccount[0]);\n        } else {\n            balanceBigN = await contract.balanceOf(defaultAccount);\n        }\n\n        let balanceNumber = balanceBigN;\n\n        let tokenDecimals = await contract.decimals();\n\n\t\tlet tokenBalance = balanceNumber / Math.pow(10, 18);\n        console.log(2 * Math.pow(10,18))\n        setBalance(tokenBalance.toFixed(5));\n    };\n\n    const maxStakeAmountHandler = () => {\n\n        if (stakeState == \"Unstake\"){   \n            setStakeAmount(stakeBalance);\n        } else {\n            setStakeAmount(balance);\n        }\n        \n    }\n\n   \n\n    useEffect(() =>{\n        \n        \n        if (contract != null){  \n\n            \n\n            if (network == 'rinkeby') {\n                updateBalance();\n                updateTokenName();\n                // approveOrStake();\n                stakeStateHandler();\n                getStakeBalance();\n            } else if (network != null){\n                setOpenModal(true);\n                setErrorMessage(\"Wrong network\");\n            }\n            \n            \n        } else {\n            setApproveOrStake(\"Approve\");\n        }\n    },[contract, defaultAccount, stakeState, txnComplete, network])\n    //contract, defaultAccount, txnPending, stakeState]\n\n    return (\n        <div className=' pt-4 bg-white pixel-border border-gray-200 shadow-md sm:p-6 lg:p-8 dark:bg-gray-800 dark:border-gray-700 '>\n            <div className=''>\n                <button className='mx-5 mb-5 px-4 py-2 bg-lime-400 hover:bg-lime-600 pixel-border text-center' onClick={() => setStakeState(\"Stake\")}>\n                    <span className=''>Stake</span>\n                </button>\n                <button className='mx-5 mb-5 px-4 py-2 bg-lime-400 hover:bg-lime-600 pixel-border text-center' onClick={() => setStakeState(\"Unstake\")}>\n                    <span>Unstake</span>\n                </button>\n                <hr className='pb-5'></hr>\n            </div>\n            <div id='stake-detail' className='mx-3'>\n                <div id='amount' className='bg-lime-500 pixel-border px-3 py-10 '>\n                        <div className='px-15 mb-2 text-left text-black'>Amount</div>\n                        <div className='flex md:mx-5 '>\n                            {/* <form className='flex' onSubmit={stakeHandler}> */}\n                            <div className='ml-10 mr-4'>\n                                <input className='pixel-border xl:text-xl lg:text-xl md:text-xl sm:text-xl' onChange= {(e) => {setStakeAmount(e.target.value);approveStakeHandler(e.target.value)}} id='stakeAmount' type='number' min='0' step='0.001' placeholder='0' value={stakeAmountState}></input>\n                            </div>\n                            <button className='pixel-border bg-lime-200 w-16 hover:bg-lime-600' onClick={(e) => {maxStakeAmountHandler()}}>\n                                <span>Max</span>\n                            </button>\n                            {/* </form> */}\n                        </div>\n                        \n                    \n\n\n                </div>\n                \n                {/* <form onSubmit={unstakeHandler}>\n                    <h3>Unstake tokens </h3>\n                    <p>Amount</p>\n                    <input type='number' id='unstakeAmount' min='0' step='0.001' placeholder='0'></input>\n                    <button type='submit'>Unstake</button>\n                </form> */}\n            </div>\n\n            <div className='mt-10 mb-10 mr-3 ml-3  '>\n                    <div className='flex pb-10 relative'>\n                        <p className='left-0 absolute'>Balance: </p>\n                        <p className='right-0 absolute'>{balance}</p>\n                    </div>\n                    <div className='flex mb-10 relative'>\n                        <p className='left-0 absolute' >Staked balance: </p>\n                        <p className='right-0 absolute' >{stakeBalance}</p>\n                    </div>\n            </div>\n                {/* <button type='submit' onClick={stakeHandler}>{ApproveOrStake}</button> */}\n                {/* <form onSubmit={stakeHandler}>\n                    <h3>Stake tokens </h3>\n                    <p>Amount</p> */}\n                    {/* <input type='number' id='stakeAmount' min='0' step='0.001' placeholder='0'></input> */}\n                    {/* <button type='submit' onClick={stakeHandler}>{ApproveOrStake}</button> */}\n                {/* </form> */}\n                \n\n                <button disabled={stakeAmountState==0 || stakeAmountState == null} className='pixel-border bg-lime-500 disabled:bg-lime-100 active:bg-lime-500 hover:bg-lime-600 xl:w-96 lg:w-96 md:w-96 sm:w-96 w-80 py-3 my-5' type='submit' onClick={stakeHandler}>\n                    \n                {ApproveOrStake}\n                </button>\n                \n            \n            <div className='px-10'>\n                {/* {txnPending} */}\n                \n\n\n            </div>\n            {/* <div>\n\t\t\t\t{txnHash}\n\t\t\t</div> */}\n\n\n            {/* <div class=\"p-4 max-w-sm bg-white rounded-lg border border-gray-200 shadow-md sm:p-6 lg:p-8 dark:bg-gray-800 dark:border-gray-700\">\n            <form class=\"space-y-6\" action=\"#\">\n            <h5 class=\"text-xl font-medium text-gray-900 dark:text-white\">Sign in to our platform</h5>\n            <div>\n            <label for=\"email\" class=\"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300\">Your email</label>\n            <input type=\"email\" name=\"email\" id=\"email\" class=\"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white\" placeholder=\"name@company.com\" required=\"\"/>\n            </div>\n            <div>\n            <label for=\"password\" class=\"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300\">Your password</label>\n            <input type=\"password\" name=\"password\" id=\"password\" placeholder=\"••••••••\" class=\"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white\" required=\"\"/>\n            </div>\n            <div class=\"flex items-start\">\n            <div class=\"flex items-start\">\n            <div class=\"flex items-center h-5\">\n            </div>\n            <label for=\"remember\" class=\"ml-2 text-sm font-medium text-gray-900 dark:text-gray-300\">Remember me</label>\n            </div>\n            <a href=\"#\" class=\"ml-auto text-sm text-blue-700 hover:underline dark:text-blue-500\">Lost Password?</a>\n            </div>\n            <button type=\"submit\" class=\"w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800\">Login to your account</button>\n            <div class=\"text-sm font-medium text-gray-500 dark:text-gray-300\">\n            Not registered? <a href=\"#\" class=\"text-blue-700 hover:underline dark:text-blue-500\">Create account</a>\n            </div>\n            </form>\n            </div> */}\n\n\n        </div>\n        \n\n    );\n\n}\n\nexport default Interactions;"]},"metadata":{},"sourceType":"module"}
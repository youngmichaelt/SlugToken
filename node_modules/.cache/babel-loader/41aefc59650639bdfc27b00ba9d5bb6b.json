{"ast":null,"code":"import _asyncToGenerator from\"/Users/michaelyoung/repos/SlugToken/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/michaelyoung/repos/SlugToken/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/michaelyoung/repos/SlugToken/node_modules/@babel/runtime/regenerator/index.js\";import{React,useState,useEffect}from'react';import{ethers}from'ethers';import styles from'./EventTable.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var EventTable=function EventTable(props){var contract=props.contract.contract;var defaultAccount=props.contract.defaultAccount;var provider=props.contract.provider;var _useState=useState(),_useState2=_slicedToArray(_useState,2),Event=_useState2[0],setEvent=_useState2[1];var getEvents=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var contractAddress,filter,events,rows,headers,i,block,timestamp,date,num,fixedNum,row;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return contract.address;case 2:contractAddress=_context.sent;// let events = contract.filters.TaxCollected(null, defaultAccount);\n// console.log(events);\nfilter=contract.filters.TaxCollected(defaultAccount);_context.next=6;return contract.queryFilter(filter);case 6:events=_context.sent;// console.log(events[0].args);\nrows=[];headers=/*#__PURE__*/_jsxs(\"tr\",{className:\"table-fixed\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-10\",children:\"Timestamp\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-10\",children:\"Transaction Hash\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-10\",children:\"Amount\"})]},'10000');// rows.push(headers)\nif(!(events instanceof Array&&events.length>0)){_context.next=28;break;}i=events.length-1;case 11:if(!(i>-1)){_context.next=28;break;}if(!(i==events.length-10)){_context.next=14;break;}return _context.abrupt(\"break\",28);case 14:_context.next=16;return provider.getBlock(events[i].blockNumber);case 16:block=_context.sent;timestamp=block.timestamp;date=new Date(timestamp*1000);num=ethers.utils.formatUnits(events[i].args[1],18);// console.log(num)\nfixedNum=parseFloat(num);fixedNum=fixedNum.toFixed(3);console.log(events[i]);row=/*#__PURE__*/_jsxs(\"tr\",{className:\"\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"pt-3\",children:date.toDateString()}),/*#__PURE__*/_jsx(\"td\",{className:\" xl:pl-10 lg:pl-10 md:pl-10 sm:pl-10 xl:max-w-[300px] lg:max-w-[300px] md:max-w-[300px] sm:max-w-[300px] max-w-[150px] truncate ... pt-3\",children:/*#__PURE__*/_jsx(\"a\",{className:\"\",href:'https://rinkeby.etherscan.io/tx/'+events[i].transactionHash,children:events[i].transactionHash})}),/*#__PURE__*/_jsx(\"td\",{className:\"xl:pl-10 lg:pl-10 md:pl-10 sm:pl-10 xl:pr-10 lg:pr-10 md:pr-10 sm:pr-10 min-w-min pt-3\",children:fixedNum})]},i);// headers += row;\nrows.push(row);case 25:i--;_context.next=11;break;case 28:// console.log(headers);\nsetEvent(rows);case 29:case\"end\":return _context.stop();}}},_callee);}));return function getEvents(){return _ref.apply(this,arguments);};}();useEffect(function(){if(contract!=null){getEvents();}else{setEvent(\"null\");}},[contract,defaultAccount]);return/*#__PURE__*/_jsx(\"div\",{className:\"p-4 bg-white pixel-border border border-gray-200 xl:mx-32 lg:mx-20 md:mx-20 sm:mx-5 mx-3 xl:text-xl lg:text-xl md:text-xl sm:text-xl text-xl\",children:/*#__PURE__*/_jsx(\"table\",{className:\"flex justify-center table-fixed \",id:styles.eventtable,children:/*#__PURE__*/_jsxs(\"tbody\",{className:\" table-fixed \",children:[/*#__PURE__*/_jsxs(\"tr\",{className:\"table-fixed\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"xl:px-16 lg:px-16 md:px-10 sm:px-10 px-3\",children:\"Timestamp\"}),/*#__PURE__*/_jsx(\"th\",{className:\"xl:px-16 lg:px-16 md:px-10 sm:px-10 px-3\",children:\"Txn Hash\"}),/*#__PURE__*/_jsx(\"th\",{className:\"xl:px-16 lg:px-16 md:px-10 sm:px-10 px-3\",children:\"Amount\"})]},'10000'),Event]})})});};export default EventTable;","map":{"version":3,"sources":["/Users/michaelyoung/repos/SlugToken/src/EventTable.js"],"names":["React","useState","useEffect","ethers","styles","EventTable","props","contract","defaultAccount","provider","Event","setEvent","getEvents","address","contractAddress","filter","filters","TaxCollected","queryFilter","events","rows","headers","Array","length","i","getBlock","blockNumber","block","timestamp","date","Date","num","utils","formatUnits","args","fixedNum","parseFloat","toFixed","console","log","row","toDateString","transactionHash","push","eventtable"],"mappings":"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","sourcesContent":["import {React, useState, useEffect} from 'react'\nimport {ethers} from 'ethers'\nimport styles from './EventTable.module.css'\n\n\nconst EventTable = (props) => {\n    let contract = props.contract.contract;\n    let defaultAccount = props.contract.defaultAccount;\n    let provider = props.contract.provider;\n    const [Event, setEvent] = useState();\n\n    const getEvents = async () => {\n        let contractAddress = await contract.address;\n\n        // let events = contract.filters.TaxCollected(null, defaultAccount);\n        // console.log(events);\n\n        let filter = contract.filters.TaxCollected(defaultAccount)\n\n        let events = await contract.queryFilter(filter);\n        // console.log(events[0].args);\n\n        let rows = []\n\n        let headers = <tr className='table-fixed' key='10000'>\n            <th className='px-10'>Timestamp</th>\n            <th className='px-10'>Transaction Hash</th>\n            <th className='px-10'>Amount</th>\n            \n        </tr>\n\n        // rows.push(headers)\n\n        if (events instanceof Array && events.length > 0){\n            for (let i = events.length-1; i > -1; i--){\n\n                if (i == events.length-10){\n                    break;\n                }\n                let block = await provider.getBlock(events[i].blockNumber);\n                let timestamp = block.timestamp;\n                let date = new Date(timestamp*1000)\n\n                let num = ethers.utils.formatUnits(events[i].args[1], 18)\n                // console.log(num)\n                let fixedNum = parseFloat(num);\n                fixedNum = fixedNum.toFixed(3);\n                \n                \n                console.log(events[i]);\n                let row = <tr className='' key={i}>\n                    <td className='pt-3'>{date.toDateString()}</td>\n                    <td className=' xl:pl-10 lg:pl-10 md:pl-10 sm:pl-10 xl:max-w-[300px] lg:max-w-[300px] md:max-w-[300px] sm:max-w-[300px] max-w-[150px] truncate ... pt-3'>\n                        <a className='' href={'https://rinkeby.etherscan.io/tx/'+events[i].transactionHash}>{events[i].transactionHash}</a>\n                    </td>\n                    <td className='xl:pl-10 lg:pl-10 md:pl-10 sm:pl-10 xl:pr-10 lg:pr-10 md:pr-10 sm:pr-10 min-w-min pt-3'>{fixedNum}</td>\n                    \n                </tr>\n                // headers += row;\n                rows.push(row);\n            }\n        }\n        // console.log(headers);\n        setEvent(rows);\n    }\n\n    useEffect(() =>{\n        if (contract != null){\n            getEvents();\n        } else {\n            setEvent(\"null\");\n        }\n    },[contract, defaultAccount])\n\n    return (\n        <div className='p-4 bg-white pixel-border border border-gray-200 xl:mx-32 lg:mx-20 md:mx-20 sm:mx-5 mx-3 xl:text-xl lg:text-xl md:text-xl sm:text-xl text-xl'>\n            \n            <table className='flex justify-center table-fixed ' id={styles.eventtable}>\n                <tbody className=' table-fixed '>\n                <tr className='table-fixed' key='10000'>\n                    <th className='xl:px-16 lg:px-16 md:px-10 sm:px-10 px-3'>Timestamp</th>\n                    <th className='xl:px-16 lg:px-16 md:px-10 sm:px-10 px-3'>Txn Hash</th>\n                    <th className='xl:px-16 lg:px-16 md:px-10 sm:px-10 px-3'>Amount</th>\n                    \n                </tr>\n                    {Event}\n                </tbody>\n            </table>\n        </div>\n\n    );\n}\nexport default EventTable;"]},"metadata":{},"sourceType":"module"}